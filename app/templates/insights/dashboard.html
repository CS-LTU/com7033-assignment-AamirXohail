{% extends "base.html" %}
{% block content %}

<div class="row justify-content-center mb-4">
    <div class="col-lg-10">
        <div class="app-hero card border-0 shadow-sm">
            <div class="card-body d-flex flex-column flex-md-row justify-content-between align-items-md-center">
                <div>
                    <h2 class="mb-2 fw-bold">Clinical risk overview</h2>
                    <p class="mb-0 text-muted">
                        High level snapshot of the stroke dataset used in this hospital management prototype.
                        Values are recalculated directly from the CSV file.
                    </p>
                </div>
                {% if data_available %}
                    <div class="mt-3 mt-md-0 text-md-end">
                        <span class="badge app-badge-live px-3 py-2">
                            <i class="bi bi-check-circle-fill me-1"></i> Data loaded
                        </span>
                        <div class="small text-muted mt-1">
                            Source: <code>dataset/stroke_data.csv</code>
                        </div>
                    </div>
                {% else %}
                    <div class="mt-3 mt-md-0 text-md-end">
                        <span class="badge bg-danger px-3 py-2">
                            <i class="bi bi-exclamation-triangle-fill me-1"></i> Dataset missing
                        </span>
                        <div class="small text-muted mt-1">
                            Place the stroke CSV file under <code>dataset/stroke_data.csv</code>.
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if data_available %}

<div class="row justify-content-center mb-4">
    <div class="col-lg-10">
        <div class="row g-3">

            <div class="col-md-3">
                <div class="app-stat-card card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <span class="app-stat-label">Total records</span>
                            <i class="bi bi-clipboard2-data app-stat-icon"></i>
                        </div>
                        <div class="app-stat-value">{{ total_records }}</div>
                        <div class="app-stat-hint text-muted">
                            Individual patient rows in the dataset.
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="app-stat-card card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <span class="app-stat-label">Average age</span>
                            <i class="bi bi-person-lines-fill app-stat-icon"></i>
                        </div>
                        <div class="app-stat-value">
                            {{ avg_age if avg_age is not none else "N/A" }}
                        </div>
                        <div class="app-stat-hint text-muted">
                            Typical age of patients in this sample.
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="app-stat-card card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <span class="app-stat-label">Average BMI</span>
                            <i class="bi bi-heart-pulse-fill app-stat-icon"></i>
                        </div>
                        <div class="app-stat-value">
                            {{ avg_bmi if avg_bmi is not none else "N/A" }}
                        </div>
                        <div class="app-stat-hint text-muted">
                            Body mass index across the cohort.
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="app-stat-card card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <span class="app-stat-label">Stroke rate</span>
                            <i class="bi bi-thermometer-half app-stat-icon"></i>
                        </div>
                        <div class="app-stat-value">
                            {{ stroke_rate if stroke_rate is not none else "N/A" }}{% if stroke_rate is not none %}%{% endif %}
                        </div>
                        <div class="app-stat-hint text-muted">
                            Share of patients marked with a stroke outcome.
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="row justify-content-center" id="data">
    <div class="col-lg-10">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <h5 class="mb-2 fw-semibold">How this dashboard is used</h5>
                <p class="mb-2 text-muted">
                    In a realistic hospital environment, this page would not replace clinical judgement. Instead,
                    it would help teams quickly understand the composition of the monitored cohort and identify
                    whether the current sample is skewed towards specific ages, risk factors or stroke outcomes.
                </p>
                <p class="mb-0 text-muted">
                    Later sections of the application expose a structured list of patient records and a dedicated
                    data quality page that describes missing values, outliers and dataset attributes in more detail.
                </p>
            </div>
        </div>
    </div>
</div>

{% else %}

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <h5 class="mb-2 fw-semibold">Dataset not found</h5>
                <p class="mb-0 text-muted">
                    The stroke dataset is required to calculate the clinical metrics on this page.
                    Please make sure that <code>dataset/stroke_data.csv</code> exists inside the project
                    folder before reloading the dashboard.
                </p>
            </div>
        </div>
    </div>
</div>

{% endif %}

{% endblock %}
